{% extends "base.html" %}
{% load i18n %}
{% load tags %}
{% block title %}{% trans "Reports for" %} {{ward.name}}, {{ward.city.name}}{% endblock %}
{% block css %}
<style>
#map-bxl{
	height: 520px;
	width: 520px;
}
</style>
{% endblock %}

{% block script %}
{{ block.super }}
{% map_scripts %}
<script>
$(function(){
	$('#map-bxl').fmsMap();
    $('#map-bxl').fmsMap('highlightArea', '{{ ward.feature_id }}');

	{% for report in reports %}
	$('#map-bxl').fmsMap('addReport',  {% report_to_json report %}, {{ forloop.counter }});
	{% endfor %}
	
	$('#map-bxl').bind('reportselected',function(evt, point, report){
		window.location.assign('/report/' + report.id);
	});

});

</script>
{% endblock %}
{% block content %}
	<div id="fullwidth">
        <h1>{% trans "Reports for" %} {{ward.name}}</h1>
		<div id='leftcol'>
			<!--
			<p>{% for zip in ward.zipcode_set.all %}{{zip.code}}{% if not forloop.last %}, {% endif %}{% endfor %}</p>
			<p>{% blocktrans with start=date_range_start|date:"j N Y" end=date_range_end|date:"j N Y" %}Reports filed between {{ start }} and {{ end }}.{% endblocktrans %} 
			{% if older_reports_link %} (<a href="{{older_reports_link}}" %}>{% trans "See older reports" %}</a>){% endif %}</p>
			-->

			{% if not reports %}
			<p>{% trans "No problems have been reported." %}</p>
			{% endif %}
			<div id="search_results">
				{% for report in reports %}
					{% ifchanged report.status %}
					<h2>{{ report.get_status_display }}</h2>
					{% endifchanged %}
                    {% include "reports/_navigation.html" %}
                {% endfor %}
             </div>
             {% if reports %}
             <div class="fix-disclaimer">
             	<p>{% trans "Note: Fix My Street relies on users to report problems as fixed." %}</p>
             </div>
             {% endif %}
 		</div>
		<div id='rightcol'>
			<div id="map-bxl"> </div>
		</div>
	</div>
	<br/ style="clear:both;">
{% endblock %}
