{% extends "base.html" %}
{% load i18n %}
{% load tags %}
{% block title %}{% trans "Reports for" %} {{entity.name}}{% endblock %}
{% block css %}
{{ block.super }}

{% endblock %}

{% block script %}
{{ block.super }}
{% map_scripts %}
<script>
$(function(){
	$('#map-bxl').fmsMap();
    $('#map-bxl').fmsMap('highlightArea', '{{ entity.feature_id }}');

	{% for report in reports %}
	$('#map-bxl').fmsMap('addReport',  {% report_to_json report %}, {{ forloop.counter }});
	{% endfor %}
	
	$('#map-bxl').bind('reportselected',function(evt, point, report){
		window.location.assign('{{report.get_absolute_url}}');
	});

});
</script>
{% endblock %}

{% block content %}
	<div id="fullwidth">
        <h1>{% trans "Reports for" %} {{entity.name}}</h1>
		<div id='leftcol'>

			{% if not reports %}
			<p>{% trans "No problems have been reported." %}</p>
			{% endif %}
			<div id="search_results">
				{% for report in reports %}
					{% ifchanged report.status %}
					<h2>{{ report.get_status_display }}</h2>
					{% endifchanged %}
                    {% include "reports/_navigation.html" with url=report.get_absolute_url %}
                {% endfor %}
             </div>
             {% if reports %}
             <div class="fix-disclaimer">
             	<p>{% trans "Note: Fix My Street relies on users to report problems as fixed." %}</p>
             </div>
             {% endif %}
 		</div>
		<div id='rightcol'>
			<div id="map-bxl"> </div>
		</div>
	</div>
	<br/ style="clear:both;">
{% endblock %}
