<!DOCTYPE html>
<html>
    <head>
        <title>Fix My Street</title>
        <link rel="stylesheet" type="text/css" media="screen" href="jquery.mobile-1.0/jquery.mobile-1.0.css"></link>
        <link rel="stylesheet" type="text/css" media="screen" href="css/fms-mobile.css"></link>

        <meta id="viewPortId" name="viewport" content="width=device-width, initial-scale=1" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <script src="jquery/jquery-1.7.js"></script>
		<script src="phonegap-1.2.0.js"></script>
		<script src="pg-plugin-fb-connect.js"></script>
		<script src="facebook_js_sdk.js"></script>

		<script src="jquery/js/jquery-ui-1.8.16.custom.min.js"></script>
        <script src="OpenLayers-2.11/OpenLayers.js"></script>
		<script src="proj4js/lib/proj4js-combined.js"></script>

        <script src="js/fixmystreetmap.js"></script>
        <script src="js/main.js"></script>
        <script src="js/map.js"></script>
        <script src="js/home.js"></script>

        <script src="jquery.mobile-1.0/jquery.mobile-1.0.js"></script>
        <script type="text/javascript" charset="utf-8">
	        function onBodyLoad() {
	        	//if phonegap, need to toggle these
	             if (typeof navigator.device == "undefined"){
	            	console.log('LOADING...');
	            	setTimeout("onBodyLoad()", 100);
	             } else {
	            	console.log('PHONEGAP LOADED');
                    console.log("PLATFORM="+device.platform);            
                    console.log("SCREEN WIDTH="+screen.width);
                    console.log("SCREEN HEIGHT="+screen.height);
                    /*
                    var dpi = window.devicePixelRatio * 160;
                    console.log("SCREEN WIDTH=" + screen.width/dpi + 'inch');
                    console.log("SCREEN HEIGHT=" + screen.height/dpi + 'inch');
                    console.log("SCREEN WIDTH=" + screen.width/dpi*2.54 + 'cm');
                    console.log("SCREEN HEIGHT=" + screen.height/dpi*2.54 + 'cm');
                    J'ai lu que la valeur de 1dp (Density-independent pixel) vaut 1px à une densité de 160dpi (medium-dpi), donc si  le même ratio est utilisé pour devicePixelRatio (hypothèse), alors la valeur de dpi peut-être calculé.
                    Mais la valeur de ce ratio à l'aire d'être une aproximation (0.75, 1, 1.5 ou 2 mais pas de valeur intermédiare...) donc la longueur serta aussi une aproximation mais ça permettra peut-être de savoir si on se trouve sur une tablette :)
                    */
                    
                    //tdesany: Scale screen based on pixel ratio
                    //The window.devicePixelRatio DOM property. The value of this property specifies the default 
                    //scaling factor used for the current device. For example, if the value of window.devicePixelRatio is "1.0",
                    //then the device is considered a medium density (mdpi) device and default scaling is not applied to the web page; 
                    //if the value is "1.5", then the device is considered a high density device (hdpi) and the page content is scaled 1.5x; 
                    //if the value is "0.75", then the device is considered a low density device (ldpi) and the content is scaled 0.75x. 
                    //However, if you specify the "target-densitydpi" meta property (discussed below), then you can stop this default scaling behavior.
                    if (window.devicePixelRatio && window.devicePixelRatio >= 1.5) {
                        console.log("HIGH DENSITY SCREEN");
                        //$.mobile.metaViewportContent = "width=device-width, initial-scale=1, minimum-scale=1, target-densitydpi=medium-dpi";
                        $('#viewPortId').attr('content','width=device-width, initial-scale=1, minimum-scale=1, target-densitydpi=medium-dpi');
                    } else if (window.devicePixelRatio && window.devicePixelRatio > 0.75) {
                        console.log("MEDIUM DENSITY SCREEN");
                        $('#viewPortId').attr('content',"width=device-width, initial-scale=1, minimum-scale=1, target-densitydpi=low-dpi");
                    } else {
                        console.log("LOW DENSITY SCREEN");
                        $('#viewPortId').attr('content',"width=device-width, initial-scale=1, minimum-scale=1, target-densitydpi=device-dpi");
                    }
           

                    var evt = document.createEvent('Event');
                    evt.initEvent('initapp', true, true);
                    document.dispatchEvent(evt);

	            	document.addEventListener("resume", function(){
                        var evt = document.createEvent('Event');
                        evt.initEvent('initapp', true, true);
                        document.dispatchEvent(evt);
	            	}, false);
	             }
	        }
        </script>
    </head>

    <body onload="onBodyLoad()">
        <div id="home" class="panel" data-role="page">
            <div data-role="header">
                <h1>Home</h1>
            </div>

            <div data-role="content">
                <div id="welcome">
                    <center><img src="images/logo.png"/></center>
                    <p><button id="start" data-theme="b">Create a report</button></p>
<!--
                    <p><strong class="msg">Welcome to Fix My Street Brussel !</strong></p>
-->
                </div>
                <div id="resume" style="display:none;">
                    <ul data-role="listview" data-inset="true">
                        <li>
                            <a id="menu-photo" class="menuitem" data-step="0">
                                <img src="images/photo.png" class="ui-li-icon"/>
                            </a>
                        </li>
                        <li>
                            <a id="menu-category" class="menuitem" data-step="1">
                                <img src="images/category.png" class="ui-li-icon"/>
                                <span class="value"/>
                            </a>
                        </li>
                        <li>
                            <a id="menu-address" class="menuitem" data-step="2">
                                <img src="images/map.png" class="ui-li-icon"/>
                                <span class="value"/>
                            </a>
                        </li>
                        <li>
                            <a id="menu-description" class="menuitem" data-step="3">
                                <img src="images/description.png" class="ui-li-icon"/>
                                <span class="value"/>
                            </a>
                        </li>
                    </ul>
                    <p class="submit"><button data-theme="b">Submit</button></p>
                </div>
            </div>
            <div data-id="footer" data-role="footer" data-position="fixed">		
                <div data-role="navbar">
                    <ul>
                        <li>
                            <a data-transition="fade" href="#home" class="ui-btn-active ui-state-persist">
                                <img src="images/write.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#help">
                                <img src="images/info.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#config">
                                <img src="images/profile.png"/>
                            </a>
                        </li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->
        </div>

        <div id="category" class="page-step" data-role="page" data-add-back-btn="true">
            <div class="toolbar" data-role="header">
                <h1>Category</h1>
                <a class="ui-btn-right help" data-theme="b"><img src="images/info.png"/></a>
            </div>
            <div data-role="content">
                <p>Choose a category for your report</p>
                <p class="tips">The category of the problem will be use to send your report to the correct service, choose it carefully.</p>
                <ul data-role="listview" data-theme="d" data-divider-theme="e" data-inset="true">
                    <li data-role="list-divider">Propriétée public</li>
                    <li id="cat-3" data-value="3"><a>Déterioration de batiment</a></li>
                    <li id="cat-4" data-value="4"><a>Bac à fleurs, cloture et abribus</a></li>
                    <li id="cat-1" data-value="1"><a>Graffitis</a></li>
                    <li data-role="list-divider">Voie public</li>
                    <li id="cat-5" data-value="5"><a>Route et trottoir</a></li>
                    <li id="cat-6" data-value="6"><a>Avaloirs</a></li>
                    <li id="cat-7" data-value="7"><a>Eclairage public</a></li>
                    <li id="cat-7" data-value="7"><a>Plaque de rue</a></li>
                    <li id="cat-7" data-value="7"><a>Véhicules abandonnée, débrits et ordures</a></li>
                    <li data-role="list-divider">Signalisation</li>
                    <li id="cat-13" data-value="13"><a>Ralentisseur de traffic</a></li>
                    <li id="cat-15" data-value="15"><a>Passage piétons</a></li>
                    <li id="cat-16" data-value="16"><a>Feu de signalisation</a></li>
                    <li id="cat-8" data-value="8"><a>Panneau de signalisation</a></li>
                    <li id="cat-8" data-value="8"><a>Marque au sol</a></li>
                    <li data-role="list-divider">Zone verte et parcs</li>
                    <li id="cat-17" data-value="17"><a>Végétation sauvage</a></li>
                    <li id="cat-18" data-value="18"><a>Débrits et ordures</a></li>
                    <li id="cat-19" data-value="19"><a>Arbre malade ou dangereux</a></li>
                </ul>
           </div>
        </div>

        <div id="photo" class="page-step" data-role="page" data-add-back-btn="true">
            <div class="toolbar" data-role="header">
                <h1>Take a photo</h1>
                <a class="ui-btn-right help" data-theme="b"><img src="images/info.png"/></a>
            </div>

            <div data-role="content">
                <p class="tips">A photo is not required to fill a report but one picture is stronger than words, it is hightly recommended.</p>
                <div id="preview"></div>
                <p><button id="capture" data-theme="b">Take a photo</button></p>
                <p><button id="select" data-theme="c">Select in library</button></p>
                <p><button id="skip" data-theme="e">No photo</button></p>
            </div>
        </div>

        <div id="address" class="page-step" data-role="page" data-add-back-btn="true">
            <div class="toolbar" data-role="header">
                <h1>Location</h1>
                <a class="ui-btn-right help" data-theme="b"><img src="images/info.png"/></a>
            </div>
            <div data-role="content">
                <div>
                    <p class="tips">This is the address retrieved from where you are, 
                    if it is not the location of the report please locate it on the map.</p>
                    <p>The problem is located here:</p>
                    <strong class="address-validate"></strong>
                    <p><button class="address-confirm" data-theme="b">Ok</button></p>
                    <p><button class="address-invalidate" data-theme="e">Wrong, locate it on map</button></p>
                    <p class="tips">The map is only available if you are connected, 
                    if you are on mobile connection, it is not recommented.</p>
                </div>
            </div>
        </div>

        <div id="map" class="panel" data-role="page"><!-- data-add-back-btn="true">-->
            <div class="toolbar" data-role="header">
                <h1>Map</h1>
                <!--<a class="ui-btn-right next" data-theme="b">Next</a>-->
            </div>
            <div data-role="content" class="content">
            	<!--<div id="content-disabled"> </div>-->
                <div id="map-bxl">
                    <div id="instructable">
                        <p>Drag me to the correct location on the map.</p>
                    </div>
                </div>
                <form id="search-form" data-ajax="false">
                    <div id="search-box">
                        <input id="search" type="search"></input>
                    </div>
                    <ul id="proposal" style="display:none;" data-role="listview" data-inset="true"> </ul>
                </form>
                <div id="control-options" class="map-control">
                    <a id="locate" data-role="button" data-icon="locate" data-iconpos="notext"></a>
                </div>
                <div id="control-zoom" data-role="controlgroup" data-type="horizontal" class="map-control">
                    <a id="zoom-in" data-role="button" data-icon="plus" data-iconpos="notext">Zoom in</a>
                    <a id="zoom-out" data-role="button" data-icon="minus" data-iconpos="notext">Zoom out</a>
                </div>
                <a class="confirm" data-role="button" data-theme="b">Confirm</a>
            </div>
        </div>

        <div id="description" class="page-step" data-role="page" data-add-back-btn="true">
            <div class="toolbar" data-role="header">
                <h1>Description</h1>
                <a class="ui-btn-right help" data-theme="b"><img src="images/info.png"/></a>
            </div>
            <div data-role="content">
                <p class="tips">If you have some additional comments on the location for instance, you can write it here.</p>
                <p>Write a description of the problem</p>
                <p>
                    <textarea id="id_desc" name="desc"></textarea>
                </p>
                <p class="buttons"><button data-theme="b" data-inline="true">Ok</button></p>
            </div>
        </div>

        <div id="help" class="panel" data-role="page">
            <div class="toolbar" data-role="header">
                <h1>About Fix My Street Brussels</h1>
            </div>
            <div data-role="content">
                <p>Fix My Street Brussels is maintained by CIBG (<a href="http://www.cirb.irisnet.be">www.cirb.irisnet.be</a>).</p>
                <p>The original concept was inspired by <a href="http://mysociety.org">MySociety's</a> <a href="http://fixmystreet.org">example</a>, 
                which was adapted for Brussels by CIRB</p>
                <p>the project was forked from the open source project fixmystreet.ca by <a href="http://visiblegovernment.ca">visiblegovernment.ca</a>.</p>
                <p>FixMyStreet Brussels support only collectives from Brussels, all of them are represented on the site.</p>
                <p>FixMyStreet Brussels is not responsible for the content and accuracy of material submitted by its users. 
                All reports are accepted on the basis that they contain no illegal content, 
                and we reserve the right to remove any problems or updates which we consider to be inappropriate 
                upon being informed by a user of the site.</p>
            </div>
            <div data-id="footer" data-role="footer" data-position="fixed">		
                <div data-role="navbar">
                    <ul>
                        <li>
                            <a data-transition="fade" href="#home">
                                <img src="images/write.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#help" class="ui-btn-active ui-state-persist">
                                <img src="images/info.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#config">
                                <img src="images/profile.png"/>
                            </a>
                        </li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->
        </div>

        <div id="config" class="panel" data-role="page">
            <div class="toolbar" data-role="header">
                <h1>Configuration</h1>
            </div>
            <div data-role="content">
                <p id="login-status">To create a report you have to login</p>
                <p><button id="login-fb">Facebook</button></p>
                <p style="display:none;"><button id="disconnect" data-theme="e">Disconnect</button></p>
                <p style="display:none;"><a id="back-report" data-role="button" data-transition="fade" href="#home" data-theme="b">Back to my report</a></p>
            </div>
            <div data-id="footer" data-role="footer" data-position="fixed">		
                <div data-role="navbar">
                    <ul>
                        <li>
                            <a data-transition="fade" href="#home">
                                <img src="images/write.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#help">
                                <img src="images/info.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#config" class="ui-btn-active ui-state-persist">
                                <img src="images/profile.png"/>
                            </a>
                        </li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->
        </div>
    </body>
</html>
