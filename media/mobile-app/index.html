<!DOCTYPE html>
<html>
    <head>
        <title>Fix My Street</title>
        <link rel="stylesheet" type="text/css" media="screen" href="jquery.mobile-1.0/jquery.mobile-1.0.css"></link>
        <link rel="stylesheet" type="text/css" media="screen" href="css/fms-mobile.css"></link>

        <meta id="viewPortId" name="viewport" content="width=device-width, initial-scale=1" />
        
        <script src="jquery/jquery-1.7.js"></script>
		<script src="phonegap-1.2.0.js"></script>
		<script src="pg-plugin-fb-connect.js"></script>
		<script src="facebook_js_sdk.js"></script>

		<script src="jquery/js/jquery-ui-1.8.16.custom.min.js"></script>
        <script src="OpenLayers-2.11/OpenLayers.js"></script>
		<script src="proj4js/lib/proj4js-combined.js"></script>

        <script src="js/fixmystreetmap.js"></script>
        <script src="js/main.js"></script>
        <script src="js/map.js"></script>
        <script src="js/home.js"></script>

        <script src="jquery.mobile-1.0/jquery.mobile-1.0.js"></script>
        <script type="text/javascript" charset="utf-8">
	        function onBodyLoad() {
	        	//if phonegap, need to toggle these
	             if (typeof navigator.device == "undefined"){
	            	console.log('LOADING...');
	            	setTimeout("onBodyLoad()", 100);
	             } else {
	            	console.log('PHONEGAP LOADED');
                    console.log("PLATFORM="+device.platform);            
                    console.log("SCREEN WIDTH="+screen.width);
                    console.log("SCREEN HEIGHT="+screen.height);
                    /*
                    var dpi = window.devicePixelRatio * 160;
                    console.log("SCREEN WIDTH=" + screen.width/dpi + 'inch');
                    console.log("SCREEN HEIGHT=" + screen.height/dpi + 'inch');
                    console.log("SCREEN WIDTH=" + screen.width/dpi*2.54 + 'cm');
                    console.log("SCREEN HEIGHT=" + screen.height/dpi*2.54 + 'cm');
                    J'ai lu que la valeur de 1dp (Density-independent pixel) vaut 1px à une densité de 160dpi (medium-dpi), donc si  le même ratio est utilisé pour devicePixelRatio (hypothèse), alors la valeur de dpi peut-être calculé.
                    Mais la valeur de ce ratio à l'aire d'être une aproximation (0.75, 1, 1.5 ou 2 mais pas de valeur intermédiare...) donc la longueur serta aussi une aproximation mais ça permettra peut-être de savoir si on se trouve sur une tablette :)
                    */
                    
                    //tdesany: Scale screen based on pixel ratio
                    //The window.devicePixelRatio DOM property. The value of this property specifies the default 
                    //scaling factor used for the current device. For example, if the value of window.devicePixelRatio is "1.0",
                    //then the device is considered a medium density (mdpi) device and default scaling is not applied to the web page; 
                    //if the value is "1.5", then the device is considered a high density device (hdpi) and the page content is scaled 1.5x; 
                    //if the value is "0.75", then the device is considered a low density device (ldpi) and the content is scaled 0.75x. 
                    //However, if you specify the "target-densitydpi" meta property (discussed below), then you can stop this default scaling behavior.
                    if (window.devicePixelRatio && window.devicePixelRatio >= 1.5) {
                        console.log("HIGH DENSITY SCREEN");
                        //$.mobile.metaViewportContent = "width=device-width, initial-scale=1, minimum-scale=1, target-densitydpi=medium-dpi";
                        $('#viewPortId').attr('content','width=device-width, initial-scale=1, minimum-scale=1, target-densitydpi=medium-dpi');
                    } else if (window.devicePixelRatio && window.devicePixelRatio > 0.75) {
                        console.log("MEDIUM DENSITY SCREEN");
                        $('#viewPortId').attr('content',"width=device-width, initial-scale=1, minimum-scale=1, target-densitydpi=low-dpi");
                    } else {
                        console.log("LOW DENSITY SCREEN");
                        $('#viewPortId').attr('content',"width=device-width, initial-scale=1, minimum-scale=1, target-densitydpi=device-dpi");
                    }
           

                    var evt = document.createEvent('Event');
                    evt.initEvent('initapp', true, true);
                    document.dispatchEvent(evt);

	            	document.addEventListener("resume", function(){
                        var evt = document.createEvent('Event');
                        evt.initEvent('initapp', true, true);
                        document.dispatchEvent(evt);
	            	}, false);
	             }
	        }
        </script>
    </head>

    <body onload="onBodyLoad()">
        <div id="home" class="panel" data-role="page">
            <div data-role="header">
                <h1>Home</h1>
            </div>

            <div data-role="content">
                <div id="welcome">
                    <p><strong class="msg"></strong></p>
                    <p><button id="start">Create a report</button></p>
                </div>
                <div id="resume" style="display:none;">
                    <ul data-role="listview" data-inset="true">
                        <li>
                            <a id="menu-category" class="menuitem" data-step="0">
                                <img src="images/category.png" class="ui-li-icon"/>
                                <span class="value"/>
                            </a>
                        </li>
                        <li>
                            <a id="menu-address" class="menuitem" data-step="1">
                                <img src="images/map.png" class="ui-li-icon"/>
                                <span class="value"/>
                            </a>
                        </li>
                        <li>
                            <a id="menu-description" class="menuitem" data-step="3">
                                <img src="images/description.png" class="ui-li-icon"/>
                                <span class="value"/>
                            </a>
                        </li>
                        <li>
                            <a id="menu-photo" class="menuitem" data-step="2"> </a>
                        </li>
                    </ul>
                    <p class="submit"><button>Submit</button></p>
                </div>
            </div>
            <div data-id="footer" data-role="footer" data-position="fixed">		
                <div data-role="navbar">
                    <ul>
                        <li>
                            <a data-transition="fade" href="#home" class="ui-btn-active ui-state-persist">
                                <img src="images/write.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#help">
                                <img src="images/info.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#config">
                                <img src="images/profile.png"/>
                            </a>
                        </li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->
        </div>

        <div id="category" class="panel" data-role="page" data-add-back-btn="true">
            <div class="toolbar" data-role="header">
                <h1>Choose a category</h1>
                <a class="ui-btn-right help" data-theme="b">Help</a>
            </div>
            <div data-role="content">
                <ul data-role="listview">
                    <li data-role="list-divider">Parks</li>
                    <li id="cat-3" data-value="3"><a>Lights Malfunctioning in Park</a></li>
                    <li id="cat-4" data-value="4"><a>Debris or Litter in Park</a></li>
                    <li id="cat-1" data-value="1"><a>Broken or Damaged Equipment/Play Structures</a></li>
                    <li id="cat-2" data-value="2"><a>Full or Overflowing Garbage Cans</a></li>
                    <li data-role="list-divider">Grafitti</li>
                    <li id="cat-5" data-value="5"><a>Graffiti On City Property</a></li>
                    <li id="cat-6" data-value="6"><a>Graffiti on Private Property</a></li>
                    <li id="cat-7" data-value="7"><a>Graffiti  on Utility Transformers Mailboxes, etc..</a></li>
                    <li data-role="list-divider">Roads/Sidewalks/Pathways</li>
                    <li id="cat-13" data-value="13"><a>Damaged Guardrails</a></li>
                    <li id="cat-15" data-value="15"><a>Bus Shelter Damaged</a></li>
                    <li id="cat-16" data-value="16"><a>Debris/Litter in Bus Shelter</a></li>
                    <li id="cat-8" data-value="8"><a>Blocked or damaged Catch basin / Manhole</a></li>
                    <li id="cat-9" data-value="9"><a>Pothole</a></li>
                    <li id="cat-10" data-value="10"><a>Damaged Curb</a></li>
                    <li id="cat-14" data-value="14"><a>Full or Overflowing Garbage Cans</a></li>
                    <li id="cat-11" data-value="11"><a>Debris or Litter on Road/Sidewalk/Pathway</a></li>
                    <li id="cat-12" data-value="12"><a>Blocked or Damaged Culvert</a></li>
                    <li data-role="list-divider">Trees</li>
                    <li id="cat-20" data-value="20"><a>Branches Blocking Signs or Intersection</a></li>
                    <li data-role="list-divider">Traffic Signals</li>
                    <li id="cat-17" data-value="17"><a>Street Lights Out or Malfunctioning</a></li>
                    <li id="cat-18" data-value="18"><a>Faded/Damaged/Missing Pavement Markings</a></li>
                    <li id="cat-19" data-value="19"><a>Bent/Damaged/Missing Street Signs</a></li>
                </ul>
           </div>
        </div>

        <div id="photo" class="panel" data-role="page" data-add-back-btn="true">
            <div class="toolbar" data-role="header">
                <h1>Take a photo</h1>
                <a class="ui-btn-right help" data-theme="b">Help</a>
            </div>

            <div data-role="content">
                <div id="preview"></div>
                <p><button id="capture" data-theme="b">Take a photo</button></p>
                <p><button id="select" data-theme="c">Select in library</button></p>
                <p><button id="skip" data-theme="e">No photo</button></p>
            </div>
        </div>

        <div id="address" class="panel" data-role="page" data-add-back-btn="true">
            <div class="toolbar" data-role="header">
                <h1>Location</h1>
                <a class="ui-btn-right help" data-theme="b">Help</a>
            </div>
            <div data-role="content">
                <div>
                    <p>The problem is located here:</p>
                    <strong class="address-validate"></strong>
                    <p><button class="address-confirm" data-theme="b">Ok</button></p>
                    <p><button class="address-invalidate" data-theme="e">Wrong, locate it on map</button></p>
                </div>
            </div>
        </div>

        <div id="map" class="panel" data-role="page"><!-- data-add-back-btn="true">-->
            <div class="toolbar" data-role="header">
                <h1>Map</h1>
                <!--<a class="ui-btn-right next" data-theme="b">Next</a>-->
            </div>
            <div data-role="content" class="content">
            	<!--<div id="content-disabled"> </div>-->
                <div id="map-bxl">
                    <div id="instructable">
                        <p>Drag me to the correct location on the map.</p>
                    </div>
                </div>
                <form id="search-form" data-ajax="false">
                    <div id="search-box">
                        <input id="search" type="search"></input>
                    </div>
                    <ul id="proposal" style="display:none;" data-role="listview" data-inset="true"> </ul>
                </form>
                <div id="control-zoom" data-role="controlgroup" data-type="horizontal">
                    <a id="zoom-in" data-role="button" data-icon="plus" data-iconpos="notext">Zoom in</a>
                    <a id="zoom-out" data-role="button" data-icon="minus" data-iconpos="notext">Zoom out</a>
                </div>
                <a class="confirm" data-role="button" data-theme="b">Confirm</a>
            </div>
        </div>

        <div id="description" class="panel" data-role="page" data-add-back-btn="true">
            <div class="toolbar" data-role="header">
                <h1>Fill a description</h1>
                <a class="ui-btn-right help" data-theme="b">Help</a>
            </div>
            <div data-role="content">
                <p>
                    <textarea id="id_desc" name="desc"></textarea>
                </p>
                <p class="buttons"><button data-theme="c" data-inline="true">Ok</button></p>
            </div>
        </div>

        <div id="help" class="panel" data-role="page">
            <div class="toolbar" data-role="header">
                <h1>Help for Fix My Street Brussels</h1>
            </div>
            <div data-role="content">
                <p>Fix My Street Brussels is maintained by CIBG (<a href="http://www.cirb.irisnet.be">www.cirb.irisnet.be</a>).</p>
                <p>The original concept was inspired by <a href="http://mysociety.com">MySociety's</a> <a href="http://fixmystreet.org">example</a>, 
                which was adapted for Brussels by CIRB</p>
                <p>the project was forked from the open source project fixmystreet.ca by visiblegovernment.ca.</p>
                <p>FixMyStreet Brussels support only collectives from Brussels, all of them are represented on the site.</p>
                <p>FixMyStreet Brussels is not responsible for the content and accuracy of material submitted by its users. 
                All reports are accepted on the basis that they contain no illegal content, 
                and we reserve the right to remove any problems or updates which we consider to be inappropriate 
                upon being informed by a user of the site.</p>
            </div>
            <div data-id="footer" data-role="footer" data-position="fixed">		
                <div data-role="navbar">
                    <ul>
                        <li>
                            <a data-transition="fade" href="#home">
                                <img src="images/write.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#help" class="ui-btn-active ui-state-persist">
                                <img src="images/info.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#config">
                                <img src="images/profile.png"/>
                            </a>
                        </li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->
        </div>

        <div id="config" class="panel" data-role="page">
            <div class="toolbar" data-role="header">
                <h1>Configuration</h1>
            </div>
            <div data-role="content" class="content">
                <p>You need to bee connected</p>
                <p><button id="login-fb">Facebook</button></p>
            </div>
            <div data-id="footer" data-role="footer" data-position="fixed">		
                <div data-role="navbar">
                    <ul>
                        <li>
                            <a data-transition="fade" href="#home">
                                <img src="images/write.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#help">
                                <img src="images/info.png"/>
                            </a>
                        </li>
                        <li>
                            <a data-transition="fade" href="#config" class="ui-btn-active ui-state-persist">
                                <img src="images/profile.png"/>
                            </a>
                        </li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->
        </div>
    </body>
</html>
